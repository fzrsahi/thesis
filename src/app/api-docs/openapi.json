{
  "openapi": "3.0.0",
  "info": {
    "title": "Thesis API",
    "description": "API documentation for Fazrul Anugrah Sahidin's thesis project",
    "version": "0.1.0",
    "contact": {
      "email": "fazrul.anugrah@gmail.com"
    }
  },
  "servers": [
    {
      "url": "/api",
      "description": "API server"
    }
  ],
  "paths": {
    "/auth/session": {
      "get": {
        "tags": ["Auth"],
        "summary": "Get session information",
        "description": "Retrieve session information for the authenticated user",
        "operationId": "getSession",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved session information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "user": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "example": "student"
                        },
                        "email": {
                          "type": "string",
                          "example": "student@gmail.com"
                        },
                        "id": {
                          "type": "string",
                          "example": "1"
                        },
                        "role": {
                          "type": "string",
                          "example": "student"
                        }
                      },
                      "required": ["name", "email", "id", "role"]
                    },
                    "expires": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2025-07-03T14:08:10.770Z"
                    }
                  },
                  "required": ["user", "expires"]
                }
              }
            }
          }
        }
      }
    },
    "/my-recommendation": {
      "get": {
        "tags": ["Recommendation"],
        "summary": "Get personalized competition recommendations",
        "description": "Fetches personalized recommendations for the logged-in student, processed in the background using LLM and RAG.",
        "operationId": "getMyRecommendations",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved recommendations",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Recommendation"],
        "summary": "Generate student recommendation",
        "description": "Generate a new recommendation for the student",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Recommendation generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/students/personal-data": {
      "get": {
        "tags": ["Student"],
        "summary": "Get student personal data",
        "description": "Retrieve current student's personal profile information",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Student personal data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "email": {
                          "type": "string"
                        },
                        "studentId": {
                          "type": "string"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Student"],
        "summary": "Update student personal data",
        "description": "Update student's personal profile information",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StudentPersonalDataUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Student personal data updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/StudentPersonalData"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/students/academic-data": {
      "get": {
        "tags": ["Student"],
        "summary": "Get student academic data",
        "description": "Retrieve all academic information for the current student including achievements and memberships",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Student academic data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/StudentAcademicData"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Student"],
        "summary": "Update student academic data",
        "description": "Update student's academic information including achievements and memberships",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StudentAcademicDataUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Student academic data updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/StudentAcademicData"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/students/transcript": {
      "post": {
        "tags": ["Student"],
        "summary": "Upload student transcript",
        "description": "Upload student's transcript file",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "transcript": {
                    "type": "string",
                    "format": "binary",
                    "description": "Transcript file upload (PDF format)"
                  },
                  "semester": {
                    "type": "string",
                    "description": "Semester of the transcript"
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["Student"],
        "summary": "Get student transcripts",
        "description": "Get all transcripts for the current student",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved transcripts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "number"
                          },
                          "semester": {
                            "type": "string"
                          },
                          "fileUrl": {
                            "type": "string"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/students/transcript/{id}": {
      "delete": {
        "tags": ["Student"],
        "summary": "Delete student transcript",
        "description": "Delete a transcript for the current student",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Transcript deleted successfully"
          }
        }
      }
    },
    "/competitions": {
      "post": {
        "tags": ["Competition"],
        "summary": "Create competition",
        "description": "Create a new competition",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateCompetitionResponse"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Competition created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": ["Competition"],
        "summary": "Get competition list",
        "description": "Get all competitions",
        "responses": {
          "200": {
            "description": "Competition list retrieved successfully"
          }
        }
      }
    },
    "/competitions/generate": {
      "post": {
        "tags": ["Competition"],
        "summary": "Generate competition",
        "description": "Generate a new competition",
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "title": {
                    "type": "string"
                  },
                  "description": {
                    "type": "string"
                  },
                  "website": {
                    "type": "string"
                  },
                  "additionalDetails": {
                    "type": "string"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "Optional file upload"
                  },
                  "startPage": {
                    "type": "integer",
                    "description": "Starting page number (optional, only if file is provided)"
                  },
                  "endPage": {
                    "type": "integer",
                    "description": "Ending page number (optional, only if file is provided)"
                  }
                },
                "required": ["title", "description", "website"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Competition generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "$ref": "#/components/schemas/GenerateCompetitionResponse"
                    }
                  },
                  "required": ["success", "data"]
                }
              }
            }
          }
        }
      }
    }
  },

  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "SuccessResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "$ref": "#/components/schemas/RecommendationResponse"
          }
        },
        "required": ["success", "data"]
      },
      "GenerateCompetitionResponse": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string",
            "description": "The exact name of the competition",
            "example": "LIDM 2025 - Inovasi Teknologi Digital Pendidikan (Divisi1)"
          },
          "description": {
            "type": "string",
            "description": "A brief overview of the competition's purpose and scope"
          },
          "field": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "The primary domain(s) of the competition",
            "example": ["Educational Technology", "Software Development"]
          },
          "type": {
            "type": "string",
            "nullable": true,
            "description": "Indicates whether participants compete solo or in groups"
          },
          "minGPA": {
            "type": "string",
            "nullable": true,
            "description": "Minimum GPA requirement for eligibility, if specified; otherwise, null"
          },
          "requirements": {
            "type": "object",
            "properties": {
              "teamComposition": {
                "type": "string",
                "nullable": true,
                "description": "Details on team size and composition",
                "example": "3-5 students from the same university"
              },
              "originality": {
                "type": "string",
                "nullable": true,
                "description": "Rules about the originality of submissions",
                "example": "Work must be original"
              },
              "other": {
                "type": "string",
                "nullable": true,
                "description": "Additional eligibility criteria",
                "example": "Must submit a proposal"
              }
            },
            "required": ["teamComposition", "originality", "other"]
          },
          "startDate": {
            "type": "string",
            "nullable": true,
            "description": "The competition's start or registration date (YYYY-MM-DD format)",
            "example": "2025-01-01"
          },
          "endDate": {
            "type": "string",
            "nullable": true,
            "description": "The competition's end or final date (YYYY-MM-DD format)",
            "example": "2025-01-01"
          },
          "location": {
            "type": "string",
            "nullable": true,
            "description": "The event's location, e.g., 'Online' or a specific city/university; null if unspecified"
          },
          "organizer": {
            "type": "string",
            "nullable": true,
            "description": "The organizing entity",
            "example": "Ministry of Education"
          },
          "evaluationCriteria": {
            "type": "object",
            "properties": {
              "preliminaryRound": {
                "type": "string",
                "nullable": true,
                "description": "Criteria for initial judging",
                "example": "Originality: 30%, Impact: 30%"
              },
              "finalRound": {
                "type": "string",
                "nullable": true,
                "description": "Criteria for final judging",
                "example": "Presentation and functionality"
              },
              "other": {
                "type": "string",
                "nullable": true,
                "description": "Other evaluation criteria"
              }
            },
            "required": ["preliminaryRound", "finalRound", "other"]
          },
          "competitionStatistics": {
            "type": "object",
            "properties": {
              "summary": {
                "type": "string",
                "nullable": true,
                "description": "A brief overview of historical participation data, including years and sources"
              },
              "totalApplicantsPastYear": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "count": {
                      "type": "integer",
                      "nullable": true,
                      "description": "Number of teams or individuals who applied in the specified year"
                    },
                    "year": {
                      "type": "string",
                      "nullable": true,
                      "description": "The year of the applicant data",
                      "example": "2023"
                    }
                  },
                  "required": ["count", "year"]
                }
              },
              "pastUngParticipants": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "year": {
                      "type": "string",
                      "description": "Year of participation"
                    },
                    "name": {
                      "type": "string",
                      "description": "Name of the participant from UNG"
                    },
                    "count": {
                      "type": "integer",
                      "description": "Number of team members or 1 if individual"
                    }
                  },
                  "required": ["year", "name", "count"]
                }
              }
            },
            "required": [
              "summary",
              "totalApplicantsPastYear",
              "finalistCountPastYear",
              "pastUngParticipants"
            ]
          },
          "sourceUrl": {
            "type": "string",
            "description": "The primary website or document URL for the competition"
          },
          "relevantCourses": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Academic courses directly relevant to the competition's technical or non-technical focus",
            "example": ["Software Engineering", "Instructional Design"]
          },
          "relevantSkills": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Skills directly relevant to the competition's technical or non-technical requirements",
            "example": ["Python", "Instructional Design"]
          }
        },
        "required": [
          "title",
          "description",
          "field",
          "type",
          "minGPA",
          "requirements",
          "startDate",
          "endDate",
          "location",
          "organizer",
          "evaluationCriteria",
          "competitionStatistics",
          "sourceUrl",
          "relevantCourses",
          "relevantSkills"
        ]
      },
      "RecommendationResponse": {
        "type": "object",
        "properties": {
          "student": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "example": "student"
              },
              "email": {
                "type": "string",
                "example": "student@gmail.com"
              }
            },
            "required": ["name", "email"],
            "description": "Basic student information"
          },
          "result": {
            "type": "object",
            "properties": {
              "studentSummary": {
                "type": "string",
                "description": "Comprehensive summary of the student's academic and professional background",
                "example": "Mahasiswa dengan IPK 3.66, menunjukkan keunggulan akademik di bidang Teknik Informatika. Memiliki minat utama pada Programming, Backend Development, dan Software Engineering."
              },
              "skillsProfile": {
                "type": "object",
                "additionalProperties": {
                  "type": "object",
                  "properties": {
                    "score": {
                      "type": "number",
                      "format": "float",
                      "minimum": 0,
                      "maximum": 1
                    },
                    "breakdown": {
                      "type": "string"
                    }
                  },
                  "required": ["score", "breakdown"]
                },
                "example": {
                  "technicalExpertise": {
                    "score": 0.92,
                    "breakdown": "Mahasiswa memiliki pengalaman teknis yang sangat kuat: peran sebagai Software Developer di Jepang dengan kontribusi pada pengembangan sistem AI dan LMS menggunakan NestJS."
                  },
                  "scientificWriting": {
                    "score": 0.65,
                    "breakdown": "Mahasiswa mampu menyusun laporan teknis yang baik, terbukti dari pengalaman kerja di berbagai proyek backend dan dokumentasi API."
                  }
                },
                "description": "Detailed skill profile with scores and explanations"
              },
              "overallAssessment": {
                "type": "object",
                "properties": {
                  "strengths": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": [
                      "Penguasaan teknis backend dan pengembangan API yang sangat baik",
                      "Kemampuan problem solving yang kuat dalam konteks proyek nyata"
                    ]
                  },
                  "weaknesses": {
                    "type": "array",
                    "items": {
                      "type": "string"
                    },
                    "example": [
                      "Kurangnya pengalaman dalam penulisan karya ilmiah formal",
                      "Belum ada bukti pencapaian signifikan dalam bisnis atau kewirausahaan"
                    ]
                  }
                },
                "required": ["strengths", "weaknesses"],
                "description": "Overall assessment of student's profile"
              },
              "recommendations": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "integer",
                      "example": 1
                    },
                    "competitionName": {
                      "type": "string",
                      "example": "PKM-KC"
                    },
                    "rank": {
                      "type": "integer",
                      "example": 1
                    },
                    "matchScore": {
                      "type": "object",
                      "properties": {
                        "score": {
                          "type": "number",
                          "format": "float",
                          "minimum": 0,
                          "maximum": 1,
                          "example": 0.82
                        },
                        "reason": {
                          "type": "string",
                          "example": "Mahasiswa memiliki keahlian teknis dan problem solving yang relevan untuk menciptakan prototipe inovatif."
                        }
                      },
                      "required": ["score", "reason"]
                    },
                    "skillRequirements": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "object",
                        "properties": {
                          "weight": {
                            "type": "number",
                            "format": "float",
                            "minimum": 0,
                            "maximum": 1
                          },
                          "breakdown": {
                            "type": "string"
                          }
                        },
                        "required": ["weight", "breakdown"]
                      },
                      "example": {
                        "technicalExpertise": {
                          "weight": 0.8,
                          "breakdown": "Keahlian teknis sangat penting untuk mengembangkan prototipe berkualitas tinggi."
                        }
                      }
                    },
                    "reasoning": {
                      "type": "object",
                      "properties": {
                        "summary": {
                          "type": "string",
                          "example": "Kompetisi ini cocok untuk mahasiswa karena memanfaatkan keahlian teknis dan kemampuan problem solving yang dimilikinya."
                        },
                        "pros": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "example": [
                            "Keahlian teknis mahasiswa sangat sesuai dengan kebutuhan kompetisi"
                          ]
                        },
                        "cons": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "example": [
                            "Kurangnya pengalaman penulisan ilmiah dapat menjadi tantangan"
                          ]
                        }
                      },
                      "required": ["summary", "pros", "cons"]
                    },
                    "keyFactors": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "Keahlian teknis dalam pengembangan prototipe",
                        "Kemampuan problem solving yang relevan"
                      ]
                    },
                    "preparationTips": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "Perbaiki keterampilan penulisan ilmiah untuk mendukung dokumentasi ide",
                        "Latih presentasi untuk meningkatkan komunikasi selama kompetisi"
                      ]
                    }
                  },
                  "required": [
                    "id",
                    "competitionName",
                    "rank",
                    "matchScore",
                    "skillRequirements",
                    "reasoning",
                    "keyFactors",
                    "preparationTips"
                  ]
                },
                "description": "List of recommended competitions"
              },
              "developmentSuggestions": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["course", "practice", "certification"],
                      "example": "course"
                    },
                    "title": {
                      "type": "string",
                      "example": "Scientific Writing Essentials"
                    },
                    "link": {
                      "type": "string",
                      "format": "uri",
                      "example": "https://www.coursera.org/learn/sciwrite"
                    },
                    "reason": {
                      "type": "string",
                      "example": "Kursus ini akan membantu mahasiswa memperkuat kemampuan penulisan ilmiah yang dibutuhkan untuk kompetisi."
                    }
                  },
                  "required": ["type", "title", "link", "reason"]
                },
                "description": "Development suggestions for skill improvement"
              }
            },
            "required": [
              "studentSummary",
              "skillsProfile",
              "overallAssessment",
              "recommendations",
              "developmentSuggestions"
            ]
          }
        },
        "required": ["student", "result"]
      },
      "StudentPersonalData": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "studentId": {
            "type": "string"
          },
          "major": {
            "type": "string"
          },
          "interests": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "StudentPersonalDataUpdate": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "studentId": {
            "type": "string"
          }
        }
      },
      "StudentAcademicData": {
        "type": "object",
        "properties": {
          "gpa": {
            "type": "string"
          },
          "interests": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "skills": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "achievements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Achievement"
            }
          },
          "experiences": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Experience"
            }
          }
        }
      },
      "StudentAcademicDataUpdate": {
        "type": "object",
        "properties": {
          "gpa": {
            "type": "string"
          },
          "interests": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "achievements": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/AchievementCreate"
            }
          },
          "experiences": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ExperienceCreate"
            }
          }
        }
      },
      "Achievement": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "date": {
            "type": "string",
            "format": "date"
          }
        }
      },
      "AchievementCreate": {
        "type": "object",
        "properties": {
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "date": {
            "type": "string",
            "format": "date"
          }
        },
        "required": ["title", "description", "date"]
      },
      "Experience": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer"
          },
          "organization": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "position": {
            "type": "string"
          },
          "startDate": {
            "type": "string",
            "format": "date-time"
          },
          "endDate": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "ExperienceCreate": {
        "type": "object",
        "properties": {
          "organization": {
            "type": "string"
          },
          "position": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "startDate": {
            "type": "string",
            "format": "date-time"
          },
          "endDate": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["organization", "position", "startDate", "description"]
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": {
            "type": "string"
          },
          "message": {
            "type": "string"
          }
        }
      }
    }
  },
  "security": [
    {
      "bearerAuth": []
    }
  ]
}
